<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>For You ‚ù§Ô∏è</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚ù§Ô∏è</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pacifico&family=Quicksand:wght@400;700&display=swap');
        body { font-family: 'Quicksand', sans-serif; background: linear-gradient(180deg, #e0f2fe 0%, #fbcfe8 100%); touch-action: manipulation; overflow: hidden; height: 100vh; }
        .font-romantic { font-family: 'Pacifico', cursive; }
        
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            100% { transform: translate(0px, 0px) rotate(0deg); }
        }
        .shake-active { animation: shake 0.3s; }

        .bg-heart { position: absolute; color: rgba(255, 77, 109, 0.2); user-select: none; pointer-events: none; z-index: 0; animation: float-bg 10s linear infinite; }
        @keyframes float-bg { 0% { transform: translateY(110vh) rotate(0deg); opacity: 0; } 10% { opacity: 1; } 90% { opacity: 1; } 100% { transform: translateY(-10vh) rotate(360deg); opacity: 0; } }
        
        .watermark { position: absolute; bottom: 25px; right: 25px; font-family: 'Pacifico', cursive; color: rgba(255, 255, 255, 0.7); font-size: 1.4rem; cursor: pointer; z-index: 60; }
        
        .fade-in { animation: fadeIn 2s ease-in forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-6 relative" id="main-body">

    <div id="heart-bg-container"></div>
    <div class="watermark" id="initials"></div>

    <audio id="bg-music" loop>
        <source src="ordinary.mp3" type="audio/mpeg">
    </audio>

    <div id="game-container" class="relative z-10 text-center w-full max-w-md bg-white/40 backdrop-blur-md p-8 rounded-3xl shadow-2xl border border-white/50">
        <div class="mb-8 h-64 flex items-center justify-center">
            <img id="panda-img" src="https://media1.tenor.com/m/FdMseW_vMA0AAAAd/be-mine-will-you-be-my-valentines.gif" alt="Panda" class="rounded-2xl w-full h-full object-contain shadow-sm">
        </div>
        <h1 id="question" class="text-3xl md:text-4xl font-romantic text-pink-600 mb-10 leading-relaxed">Will you be my Valentine?</h1>
        
        <div class="flex flex-col sm:flex-row justify-center items-center gap-6" id="button-group">
            <button id="yesBtn" class="bg-green-500 text-white font-bold py-4 px-10 rounded-full shadow-xl text-2xl">Yes! üíñ</button>
            <button id="noBtn" class="bg-pink-500 text-white font-bold py-4 px-10 rounded-full shadow-lg text-xl">No</button>
        </div>

        <p id="ps-note" class="hidden text-gray-600 italic mt-6 text-sm opacity-0">P.S. this is what my Comp Sci Degree is going towards</p>
    </div>

    <script>
        // OBFUSCATION FIX: Heart emoji added directly in JS to avoid decoding errors
        const secretInitials = atob("VCArIFM="); // T + S
        const secretDateText = atob("U2luY2UgMTAvMjAvMjI="); // Since 10/20/22
        
        document.getElementById('initials').innerText = secretInitials;
        document.getElementById('initials').onclick = () => alert(secretDateText + " ‚ù§Ô∏è");

        const noBtn = document.getElementById('noBtn');
        const yesBtn = document.getElementById('yesBtn');
        const pandaImg = document.getElementById('panda-img');
        const body = document.getElementById('main-body');
        const music = document.getElementById('bg-music');
        const question = document.getElementById('question');
        const psNote = document.getElementById('ps-note');

        let clickCount = 0;
        const sadGifs = [
            "https://media1.tenor.com/m/-Y6seYBmowUAAAAd/shy-sad.gif",
            "https://media1.tenor.com/m/B7XDU1yBc-4AAAAC/sad-panda-panda.gif",
            "https://media1.tenor.com/m/oRjbbodROQAAAAAC/dead-panda-panda-dead.gif",
            "https://media1.tenor.com/m/yxGoYdNazpsAAAAd/stan-twitter-monkey.gif",
            "https://media1.tenor.com/m/3m4Kcsk0GKEAAAAd/monkey-tearing-up-monkey-crying.gif",
            "https://media1.tenor.com/m/qoHPnTX76DAAAAAC/sad-bunny.gif"
        ];

        noBtn.addEventListener('click', () => {
            clickCount++;
            body.classList.add('shake-active');
            setTimeout(() => body.classList.remove('shake-active'), 300);

            pandaImg.src = sadGifs[Math.floor(Math.random() * sadGifs.length)];

            let noScale = Math.max(0.1, 1 - (clickCount * 0.15));
            let yesScale = 1 + (clickCount * 0.2);
            noBtn.style.transform = `scale(${noScale})`;
            yesBtn.style.transform = `scale(${yesScale})`;

            if (clickCount >= 8) {
                noBtn.innerText = "Well now you dont have a choice";
                if (clickCount >= 9) noBtn.style.display = 'none';
            }
        });

        yesBtn.addEventListener('click', () => {
            // Volume set to 70%
            music.volume = 0.7;
            music.play().catch(e => console.log("Audio play failed: ", e));
            
            pandaImg.src = "https://media1.tenor.com/m/CapOmVksN9MAAAAd/menglanpanda-menglan.gif";
            question.innerText = "Yay! See you soon! ü•∞";
            document.getElementById('button-group').style.display = 'none';

            psNote.classList.remove('hidden');
            psNote.classList.add('fade-in');

            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });

            setTimeout(() => {
                if(confirm("Add our date to your Calendar?")) {
                    const icsData = [
                        "BEGIN:VCALENDAR",
                        "VERSION:2.0",
                        "BEGIN:VEVENT",
                        "DTSTART:20260215T160000",
                        "DTEND:20260215T210000",
                        "SUMMARY:Valentines 2026!",
                        "DESCRIPTION:We can move stuff around, but I'll be picking you up and we are going for dinner ;)",
                        "END:VEVENT",
                        "END:VCALENDAR"
                    ].join("\n");
                    
                    const blob = new Blob([icsData], { type: 'text/calendar;charset=utf-8' });
                    const link = document.createElement('a');
                    link.href = window.URL.createObjectURL(blob);
                    link.setAttribute('download', 'date.ics');
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }
            }, 3000);
        });

        for (let i = 0; i < 15; i++) {
            const heart = document.createElement('div');
            heart.classList.add('bg-heart');
            heart.innerHTML = '‚ù§Ô∏è';
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.animationDuration = (Math.random() * 5 + 5) + 's';
            heart.style.animationDelay = Math.random() * 5 + 's';
            document.getElementById('heart-bg-container').appendChild(heart);
        }
    </script>
</body>
</html>